<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Track your subscriptions and savings in one place.">
    <meta name="theme-color" content="#4F46E5">
    <title>Dashboard - StopTheCharge</title>
    <link rel="manifest" href="manifest.json">
    <!-- Preload stylesheet for better performance -->
    <link rel="preload" href="css/style.css" as="style" onload="this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/style.css"></noscript>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <a href="index.html" class="logo-link">üí≥ StopTheCharge</a>
            </div>
            <button class="navbar-toggle" id="navbarToggle" aria-label="Toggle navigation" aria-expanded="false" aria-controls="navbarMenu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="navbar-menu" id="navbarMenu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="directory.html" class="nav-link">Directory</a></li>
                <li><a href="dashboard.html" class="nav-link active">Dashboard</a></li>
                <li><a href="admin.html" class="nav-link">Admin</a></li>
            </ul>
        </div>
    </nav>

    <!-- Header -->
    <header class="header header-secondary">
        <div class="container">
            <h1>My Dashboard</h1>
            <p>Track and manage your subscriptions</p>
        </div>
    </header>

    <!-- Main Dashboard -->
    <div class="dashboard-container">
        <div class="container">
            <!-- Top Stats -->
            <section class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-content">
                        <p class="stat-label">Total Monthly Spending</p>
                        <p class="stat-value" id="totalMonthly">$0.00</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÇÔ∏è</div>
                    <div class="stat-content">
                        <p class="stat-label">Active Subscriptions</p>
                        <p class="stat-value" id="totalSubscriptions">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-content">
                        <p class="stat-label">This Month Saved</p>
                        <p class="stat-value" id="savedThisMonth">$0.00</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üèÜ</div>
                    <div class="stat-content">
                        <p class="stat-label">Total Saved All-Time</p>
                        <p class="stat-value" id="totalSaved">$0.00</p>
                    </div>
                </div>
            </section>

            <div class="dashboard-layout">
                <!-- Left Column -->
                <div class="dashboard-main">
                    <!-- My Subscriptions Section -->
                    <section class="dashboard-section">
                        <div class="section-header">
                            <h2>My Subscriptions</h2>
                            <button class="cta-button cta-primary" id="addSubBtn">+ Add Subscription</button>
                        </div>
                        
                        <!-- Add Subscription Form (Hidden by default) -->
                        <div class="add-subscription-form" id="addSubForm" style="display: none;">
                            <h3>Add New Subscription</h3>
                            <form id="newSubscriptionForm">
                                <div class="form-group">
                                    <label for="userEmail">Your Email *</label>
                                    <input type="email" id="userEmail" required placeholder="your@email.com">
                                </div>
                                <div class="form-group">
                                    <label for="subName">Service Name *</label>
                                    <input type="text" id="subName" required placeholder="e.g., Netflix">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="subCost">Monthly Cost *</label>
                                        <input type="number" id="subCost" required step="0.01" min="0" placeholder="0.00">
                                    </div>
                                    <div class="form-group">
                                        <label for="subRenewal">Renewal Date *</label>
                                        <input type="date" id="subRenewal" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="subCategory">Category</label>
                                    <select id="subCategory">
                                        <option value="streaming">Streaming</option>
                                        <option value="fitness">Fitness</option>
                                        <option value="software">Software</option>
                                        <option value="gaming">Gaming</option>
                                        <option value="food">Food & Grocery</option>
                                        <option value="news">News</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="cta-button cta-primary">Add Subscription</button>
                                    <button type="button" class="cta-button cta-secondary" id="cancelSubBtn">Cancel</button>
                                </div>
                            </form>
                            <div id="formResult" style="display:none; margin-top:15px; padding:10px; border-radius:5px;"></div>
                        </div>

                        <!-- Subscriptions Table -->
                        <div class="subscriptions-table-wrapper" id="subscriptionsWrapper">
                            <table class="subscriptions-table" id="subscriptionsTable">
                                <thead>
                                    <tr>
                                        <th>Service</th>
                                        <th>Category</th>
                                        <th>Cost</th>
                                        <th>Renewal Date</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="subscriptionsBody">
                                    <!-- Subscriptions will be populated by JavaScript -->
                                </tbody>
                            </table>
                            <div class="empty-message" id="emptySubscriptions" style="display: none;">
                                <p>No subscriptions yet. <a href="/public/directory.html">Browse services</a> to add one!</p>
                            </div>
                        </div>
                    </section>

                    <!-- Savings Tracker -->
                    <section class="dashboard-section">
                        <h2>Savings Tracker</h2>
                        <div class="savings-chart">
                            <p class="chart-placeholder">üìä Savings history chart would appear here</p>
                            <div class="chart-info">
                                <div class="chart-metric">
                                    <span class="metric-label">This Month</span>
                                    <span class="metric-value" id="chartThisMonth">$0</span>
                                </div>
                                <div class="chart-metric">
                                    <span class="metric-label">Last Month</span>
                                    <span class="metric-value" id="chartLastMonth">$0</span>
                                </div>
                                <div class="chart-metric">
                                    <span class="metric-label">Average/Month</span>
                                    <span class="metric-value" id="chartAverage">$0</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Right Column: Sidebar -->
                <aside class="dashboard-sidebar">
                    <!-- Upcoming Renewals -->
                    <div class="sidebar-card">
                        <h3>Upcoming Renewals</h3>
                        <div class="renewals-list" id="renewalsList">
                            <!-- Renewals will be populated by JavaScript -->
                        </div>
                        <p class="empty-message" id="emptyRenewals" style="display: none;">No renewals in the next 30 days</p>
                    </div>

                    <!-- Quick Actions -->
                    <div class="sidebar-card">
                        <h3>Quick Links</h3>
                        <ul class="quick-links">
                            <li><a href="/public/directory.html" class="quick-link-btn">üîç Browse Services</a></li>
                            <li><a href="#" class="quick-link-btn">üìß Contact Support</a></li>
                            <li><a href="#" class="quick-link-btn">üí° Tips & Tricks</a></li>
                            <li><a href="#" class="quick-link-btn">‚öôÔ∏è Settings</a></li>
                        </ul>
                    </div>

                    <!-- Cancellation Letter Generator -->
                    <div class="sidebar-card">
                        <h3>Need to Cancel?</h3>
                        <p style="font-size: 0.9rem; color: #6b7280; margin-bottom: 10px;">Generate a professional cancellation letter for any subscription.</p>
                        <button class="cta-button cta-primary" id="generateLetterBtn" style="width: 100%;">
                            ‚úâÔ∏è Generate Letter ($12)
                        </button>
                    </div>

                    <!-- Export Data -->
                    <div class="sidebar-card">
                        <button class="cta-button cta-secondary" id="exportBtn" style="width: 100%;">
                            üì• Export Data
                        </button>
                    </div>
                </aside>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 StopTheCharge. All rights reserved. Take control of your subscriptions.</p>
        </div>
    </footer>

    <!-- N8N Configuration -->
    <script src="config/n8n-config.js"></script>
    <script src="js/app.js"></script>
    <script>
        // Initialize dashboard page
        document.addEventListener('DOMContentLoaded', () => {
            initializeDashboard();
        });
    </script>
</body>
</html>
